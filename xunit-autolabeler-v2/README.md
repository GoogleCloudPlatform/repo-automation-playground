# AST Snippet Parser - Core

## What this does

This converts `repo.json` files generated by language-specific subparsers (e.g. `ast_parser/python`) into human-readable insights about Cloud DPE snippets' test structure.

It can also inject region tag data into XUnit files generated by language-specific test runners.

### Supported Languages

Current:
- Python

In progress:
- Node.js

Planned:
- PHP
- Ruby


## Usage
Help text:
```
usage: cli_bootstrap.py [-h] [--output_file OUTPUT_FILE]
                        {list-region-tags,list-source-files,inject-snippet-mapping,validate-yaml}
                        ... repo_json root_dir

positional arguments:
  {list-region-tags,list-source-files,inject-snippet-mapping,validate-yaml}
    list-region-tags
    list-source-files
    inject-snippet-mapping
    validate-yaml
  repo_json             Language-agnostic JSON parser output
  root_dir              Root directory

optional arguments:
  -h, --help            show this help message and exit
  --output_file OUTPUT_FILE
                        File to write output to. Omit to use stdout.
```

## Examples:

### Generating human-readable data

```
# List source files
python cli_bootstrap.py list-source-files ~/python-docs-samples/repo.json ~/python-docs-samples

# List region tags
python cli_bootstrap.py list-region-tags ~/python-docs-samples/repo.json ~/python-docs-samples

# Validate .drift-data.yml files
python cli_bootstrap.py validate-yml ~/python-docs-samples/repo.json ~/python-docs-samples
```

### Injecting region tags into XUnit

```
cat xunit-input.xml | python cli_bootstrap.py inject-snippet-mapping --output-file xunit-output.xml ~/python-docs-samples/repo.json ~/python-docs-samples
```

**Notes**
1) The input and output paths must point to different files. (If they point to the same file, a race condition may occur.)
2) If `--output-file` is specified, it must be specified _before_ any file paths. (Failure to do so will cause `argparse` errors.)
